export default class Slider{constructor(e,t){this.slider=document.querySelector(e),this.options=t,this.render(),this.setup()}render(){const{arrows:e,dots:t}=this.options;this.slider.classList.add("slider"),this.visible=[],this.slideItems=document.querySelectorAll(".works__column"),!0===e&&this.arrows(),!0===t&&this.dots()}setup(){this.sliderSwipe(),this.sliderPage(),this.dotActive()}arrows(){const e=document.createElement("div"),t=document.createElement("div"),s=document.createElement("div"),i=document.createElement("I"),o=document.createElement("I");this.slider.appendChild(e),e.classList.add("slider__arrows"),e.appendChild(t),t.classList.add("slider__left"),t.setAttribute("tabindex","0"),e.appendChild(s),s.classList.add("slider__right"),s.setAttribute("tabindex","0"),t.appendChild(i),i.classList.add("fas"),i.classList.add("fa-angle-left"),i.style.pointerEvents="none",s.appendChild(o),o.classList.add("fas"),o.classList.add("fa-angle-right"),o.style.pointerEvents="none"}dots(){this.dotContainer=document.createElement("div"),this.dotContainer.classList.add("slider__dots"),this.slideItems.forEach(e=>{e.classList.contains("hide")||this.visible.push(e)}),document.querySelector(".slider__dots")&&document.querySelector(".slider__dots").parentNode.removeChild(document.querySelector(".slider__dots")),this.slider.appendChild(this.dotContainer);const e=Math.ceil(this.visible.length/this.options.slidesToShow);for(let t=0;t<e;t++){const e=document.createElement("div");e.classList.add("slider__dot"),e.setAttribute("tabindex","0"),this.dotContainer.appendChild(e)}}dotActive(){document.querySelectorAll(".slider__dot").forEach((e,t)=>{e.addEventListener("click",()=>{this.prev=t*this.options.slidesToShow,this.next=this.prev+this.options.slidesToShow-1,Array.from(e.parentNode.children).forEach(e=>{e.classList.remove("active")}),e.classList.add("active")})}),this.sliderPage()}sliderPage(){this.visible.forEach((e,t)=>{e.classList.add("hide"),t>=this.prev&&t<=this.next&&e.classList.remove("hide")});const e=document.querySelectorAll(".slider__dot");for(let t=0;t<this.visible.length;t+=this.options.slidesToShow){const s=t/this.options.slidesToShow;if(this.prev===t){for(let t=0;t<e.length;t++)e[t].classList.remove("active");void 0!==e[s]&&e[s].classList.add("active")}}this.visible.forEach((e,t)=>{t%2!=0&&(e.style.marginRight="0")})}sliderSwipe(){this.prev=0,this.next=this.options.slidesToShow-1,this.slider.onmousedown=e=>{const t=e.clientX;this.slider.onmouseup=s=>{const i=s.clientX,o=t-i;0===o&&this.slideWithAngle(e),!0===this.options.sliderTouch&&(o>=100?this.swipeLeft():o<=-100&&this.swipeRight())}},this.slider.ontouchstart=e=>{const t=e.changedTouches[0].clientX;this.slider.ontouchend=e=>{const s=e.changedTouches[0].clientX,i=t-s;!0===this.options.sliderTouch&&(i>=100?this.swipeLeft():i<=-100&&this.swipeRight())}};document.querySelectorAll(".slider__dots").forEach(e=>{e.addEventListener("click",()=>{this.dotActive()})})}swipeLeft(){this.prev-=this.options.slidesToShow,this.next-=this.options.slidesToShow;let e=this.visible.length;if(e%this.options.slidesToShow!=0)do{e++}while(e%this.options.slidesToShow!=0);this.prev<0?(this.prev=e-this.options.slidesToShow,this.next=e-1):this.visible.length<=this.options.slidesToShow&&(this.prev=0,this.next=this.options.slidesToShow-1),this.sliderPage()}swipeRight(){this.prev+=this.options.slidesToShow,this.next+=this.options.slidesToShow;let e=this.visible.length;if(e%this.options.slidesToShow!=0)do{e++}while(e%this.options.slidesToShow!=0);(this.next>=e||this.visible.length<=this.options.slidesToShow)&&(this.prev=0,this.next=this.options.slidesToShow-1),this.sliderPage()}slideWithAngle(e){e.target.classList.contains("slider__left")?this.swipeLeft():e.target.classList.contains("slider__right")&&this.swipeRight()}}function anchor(){document.querySelectorAll('a[href*="#"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const s=e.getAttribute("href").substr(1);document.getElementById(s).scrollIntoView({behavior:"smooth",block:"start"})})})}function scrollToTop(){const e=document.querySelector(".up");document.addEventListener("scroll",()=>{scrollY>=500?(e.style.opacity="1",e.style.pointerEvents="all"):(e.style.opacity="0",e.style.pointerEvents="none")})}function order(){const e=document.querySelector(".order__button");e.setAttribute("disabled","disabled");const t=document.querySelector(".order__form"),s=document.querySelectorAll("input");t.addEventListener("keydown",()=>{""!==s[1].value&&""!==s[3].value?(e.removeAttribute("disabled"),e.style.cursor="pointer"):(e.setAttribute("disabled","disabled"),e.style.cursor="default")}),t.addEventListener("change",()=>{""!==s[1].value&&""!==s[3].value?(e.removeAttribute("disabled"),e.style.cursor="pointer"):(e.setAttribute("disabled","disabled"),e.style.cursor="default")})}anchor(),order(),scrollToTop(),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".order__form"),t=document.querySelector(".order__popup"),s=document.querySelector(".order__popup_close");e.addEventListener("submit",(async function(s){s.preventDefault();const i=new FormData(e),o=document.querySelector(".order__popup_result"),d=document.querySelector(".order__button");(await fetch("order.php",{method:"POST",body:i})).ok?(t.style.display="flex",o.textContent="Сообщение отправлено! Ждите моего ответа",d.setAttribute("disabled","disabled"),e.reset()):(t.style.display="flex",o.textContent="Ошибка! Попробуйте заного")})),s.addEventListener("click",()=>{t.style.display="none"})});